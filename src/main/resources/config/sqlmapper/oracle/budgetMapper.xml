<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="budget.BudgetDAO">

    <!-- 월급, 월급일 insert -->
    <update id="updateIncome" parameterType="map">
        update T_MYONE set income=#{income}, incomeDate=#{incomeDate}
        where accountNo=#{accountNo}
    </update>
   
    <select id="getIncomeData" resultType="kr.ac.kopo.myBank.MyBankVO" parameterType="String">
        select * from T_MYONE where accountNo=#{accountNo}
    </select>
   
 
    <insert id="insertFixed" parameterType="map">
        insert into T_FIXED_COST(accountNo, pocketCode, fixedName, fixedCost, fixedDate) 
        values(#{accountNo}, 2, #{fixedName}, #{fixedCost}, #{fixedDate})
    </insert>
    
    <select id="getFixedData" resultType="kr.ac.kopo.budget.FixedVO" parameterType="map">
        select * from T_FIXED_COST where accountNo=#{accountNo} and fixedName=#{fixedName}
    </select>
    
    <select id="getFixedSum" resultType="hashmap" parameterType="string">
        select accountNo, sum(fixedCost) as fixedSum from T_FIXED_COST group by accountNo having accountNo=#{accountNo}
    </select>
   
    
    <select id="getCalculation" resultType="hashmap" parameterType="string">
        select (income - b.fixedSum) as myAsset
        from t_myone a, (select accountNo, sum(fixedCost) as fixedSum from T_FIXED_COST group by accountNo) b
        where a.accountNo=b.accountNo and a.accountNo = #{accountNo}
    
    </select>

</mapper>